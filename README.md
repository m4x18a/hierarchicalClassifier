## Задача
В маркетплейс каждый день поступает множество новых товаров и каждый из них необходимо отнести в определенную категорию в дереве категорий. На это тратится много сил и времени, поэтому мы хотим научиться предсказывать категорию на основе названий и параметров товаров. 

### **Формат входных данных**
**categories_tree.csv** - файл с деревом категорий на маркетплейсе. У каждой категории есть id, заголовок и parent_id, по которому можно восстановить полный путь категории.

**train.parquet** - файл с товарами на маркетплейсе. 
У каждого товара есть:
- *id* - идентификатор товара
- *title - заголовок*
- *short_description - краткое описание*
- *name_value_characteristics - название:значение* характеристики товара, может быть несколько для одного товара и для одной характеристики. Пример: `name1: value1 | value2 | valueN_1 / name2: value1 | value2 | valueN_2 / nameK: value1 | value2 | valueN_K`
- *rating - средний рейтинг товара*
- *feedback_quantity - количество отзывов по товару*
- *category_id - категория товара(таргет)*

**test.parquet** - файл идентичный **train.parquet**, но без реального *category_id*.
Файлы *train* и *test* представленны в формате *parquet*.

### Метрики
Предсказывать листовую категорию товара может показаться тривиальной задачей, однако нам важен путь к листовой категории. Для неверно предсказанных листовых категорий мы хотим добавлять скор, если были угаданы предшествующие родительские категории на разных уровнях.
Для честной оценки многоуровневой классификации мы будем использовать видоизмененную метрику **F1**, взвешенную на размер выборки класса(при подсчете учитываются только листовые категории):

![изображение](https://user-images.githubusercontent.com/89525573/188888156-3bba4f12-a32f-4181-b223-54c2619c7306.png)

**Pi -** это набор, состоящий из классов, предсказанных для каждого сэмпла i и соотвествующих классов-предков

**Ti -** это набор, состоящий из истинных классов тестового сэмпла i и соотвествующих классов-предков

**hP** - иерархический precision

**hR** - иерархический recall

**hF** - иерархический F1 

### **Требования к решению**
Файл `result.parquet` должен содержать две колонки:
- **id** - идентификатор товара из `test.parquet`
- **predicted_category_id** - категория, предсказанная вашей моделью для соответствующего **id**.
